<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knihovna ƒåerm√°ka a Sta≈àka</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'accent-gold': '#c9a961',
                    }
                }
            }
        }
    </script>
    <style>
        .cinema-gradient {
            background: linear-gradient(135deg, #000000 0%, #1f1f1f 100%);
        }
        
        .event-card {
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .event-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }
        
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fade-in {
            animation: fade-in 0.6s ease-out;
        }





    </style>
    
    <!-- Stripe JavaScript SDK -->
    <script src="https://js.stripe.com/v3/"></script>
</head>
<body class="min-h-screen bg-gray-50">
    <!-- Navigation -->
    <header class="bg-black shadow-lg sticky top-0 z-50" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold text-white">Knihovna ƒåerm√°ka a Sta≈àka</h1>
                </div>
                
                <nav class="hidden md:flex space-x-8" id="navLinks">
                    <a href="#home" class="text-white hover:text-red-500 transition-colors duration-200 font-medium">Dom≈Ø</a>
                    <a href="#about" class="text-white hover:text-red-500 transition-colors duration-200 font-medium">O n√°s</a>
                    <a href="#program" class="text-white hover:text-red-500 transition-colors duration-200 font-medium">Program</a>
                    <a href="#team" class="text-white hover:text-red-500 transition-colors duration-200 font-medium">T√Ωm</a>
                    <!-- <a href="#instagram" class="text-white hover:text-red-500 transition-colors duration-200 font-medium">Instagram</a> -->
                    <a href="#gallery" class="text-white hover:text-red-500 transition-colors duration-200 font-medium">Galerie</a>
                    <a href="#contact" class="text-white hover:text-red-500 transition-colors duration-200 font-medium">Kontakt</a>
                </nav>
                
                <div class="hidden md:flex items-center space-x-4" style="display: none;">
                    <button class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors duration-200 font-medium">
                        Newsletter
                    </button>
                </div>
                
                <div class="md:hidden">
                    <button id="hamburger" class="text-white hover:text-red-500 transition-colors duration-200">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
            
            <!-- Mobile menu -->
            <div id="mobileMenu" class="md:hidden bg-black border-t border-gray-800 hidden">
                <div class="px-2 pt-2 pb-3 space-y-1">
                    <a href="#home" class="block px-3 py-2 text-white hover:text-red-500 transition-colors duration-200">Dom≈Ø</a>
                    <a href="#about" class="block px-3 py-2 text-white hover:text-red-500 transition-colors duration-200">O n√°s</a>
                    <a href="#program" class="block px-3 py-2 text-white hover:text-red-500 transition-colors duration-200">Program</a>
                    <a href="#team" class="block px-3 py-2 text-white hover:text-red-500 transition-colors duration-200">T√Ωm</a>
                    <!-- <a href="#instagram" class="block px-3 py-2 text-white hover:text-red-500 transition-colors duration-200">Instagram</a> -->
                    <a href="#gallery" class="block px-3 py-2 text-white hover:text-red-500 transition-colors duration-200">Galerie</a>
                    <a href="#contact" class="block px-3 py-2 text-white hover:text-red-500 transition-colors duration-200">Kontakt</a>
                    <button class="w-full mt-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors duration-200" style="display: none;">
                        Newsletter
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="relative text-white py-16" id="home" style="height: 70vh;">
        <!-- Background Image -->
        <div class="absolute inset-0 z-0">
            <img src="uvodni.jpeg" alt="Knihovna ƒåerm√°ka a Sta≈àka" class="w-full h-full object-cover">
            <div class="absolute inset-0 bg-black bg-opacity-60"></div>
        </div>
        
        <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full h-full flex items-center">
            <div class="text-center w-full">
                <p class="text-xl md:text-3xl mb-8 text-white max-w-4xl mx-auto leading-relaxed font-light">
                    Jedineƒçn√Ω kulturn√≠ prostor v Hole≈°ovic√≠ch. Najdete v nƒõm knihy, ƒåerm√°ka i Sta≈àka. Minim√°lnƒõ jedno z toho. A taky standup, nat√°ƒçen√≠ podcast≈Ø, Bookclub, workshopy nebo t≈ôeba kv√≠zy. M√°me nejlep≈°√≠ popcorn v Praze, belgick√° piva, kvalitn√≠ whisky i mnoho dal≈°√≠ho.
                </p>
                
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <a href="#program" class="bg-white text-black px-8 py-3 rounded-lg font-bold hover:bg-gray-100 transition-all duration-200 transform hover:scale-105">
                        Zobrazit program
                    </a>
                    <a href="#about" class="border-2 border-white text-white px-8 py-3 rounded-lg font-bold hover:bg-white hover:text-black transition-all duration-200 transform hover:scale-105">
                        O klubu
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Program Section -->
    <section id="program" class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-black mb-4">
                    Program
                </h2>
                <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                    Aktu√°ln√≠ akce a ud√°losti v na≈°em klubu
                </p>
            </div>
            
            <div id="eventsList" class="space-y-8">
                <!-- Events will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="about" class="py-16 bg-black">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">
                    Proƒç Knihovna ƒåerm√°ka a Sta≈àka
                </h2>
                <p class="text-lg text-gray-300 max-w-2xl mx-auto">
                    Jedineƒçn√Ω multifunkƒçn√≠ kulturn√≠ prostor na n√°b≈ôe≈æ√≠ Vltavy
                </p>
            </div>
            
            <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-4 mb-16">
                <div class="bg-white rounded-lg p-6 shadow-lg hover:shadow-xl transition-shadow duration-300 text-center">
                    <div class="text-4xl mb-4">üé≠</div>
                    <h3 class="text-xl font-semibold text-black mb-3">
                        Standup a comedy
                    </h3>
                    <p class="text-gray-600">
                        Pravideln√© stand-up veƒçery s p≈ôedn√≠mi ƒçesk√Ωmi i zahraniƒçn√≠mi komiky
                    </p>
                </div>
                
                <div class="bg-white rounded-lg p-6 shadow-lg hover:shadow-xl transition-shadow duration-300 text-center">
                    <div class="text-4xl mb-4">üí¨</div>
                    <h3 class="text-xl font-semibold text-black mb-3">
                        Rozhovory a debaty
                    </h3>
                    <p class="text-gray-600">
                        Zveme si zaj√≠mav√© hosty, debatujeme o d≈Øle≈æit√Ωch vƒõcech
                    </p>
                </div>
                
                <div class="bg-white rounded-lg p-6 shadow-lg hover:shadow-xl transition-shadow duration-300 text-center">
                    <div class="text-4xl mb-4">üéØ</div>
                    <h3 class="text-xl font-semibold text-black mb-3">
                        Workshopy
                    </h3>
                    <p class="text-gray-600">
                        Po≈ô√°d√°me workshopy o AI, m√©di√≠ch i komunikaci. A nab√≠z√≠me prostor i pro va≈°e workshopy
                    </p>
                </div>
                
                <div class="bg-white rounded-lg p-6 shadow-lg hover:shadow-xl transition-shadow duration-300 text-center">
                    <div class="text-4xl mb-4">üéôÔ∏è</div>
                    <h3 class="text-xl font-semibold text-black mb-3">
                        Podcastov√© Studio
                    </h3>
                    <p class="text-gray-600">
                        Profesion√°ln√≠ nahr√°v√°n√≠ podcast≈Ø a rozhlasov√Ωch po≈ôad≈Ø
                    </p>
                </div>
            </div>
            
            <div class="bg-white rounded-lg p-8 shadow-lg">
                <div class="grid gap-8 md:grid-cols-2">
                    <div>
                        <h3 class="text-2xl font-bold text-black mb-4">O klubu</h3>
                        <p class="text-gray-600 mb-4" id="aboutMainText">Naƒç√≠t√°n√≠...</p>
                        <p class="text-gray-600 mb-6" id="aboutDescription">Naƒç√≠t√°n√≠...</p>
                        
                        <h4 class="text-lg font-semibold text-black mb-2">Otev√≠rac√≠ doba</h4>
                        <p class="text-gray-600" id="openingHours">Naƒç√≠t√°n√≠...</p>
                    </div>
                    
                    <div class="grid gap-4 grid-cols-2">
                        <img src="interier.jpeg" alt="Interi√©r klubu" class="rounded-lg shadow-md">
                        <img src="studio.jpeg" alt="Podcastov√© studio" class="rounded-lg shadow-md">
                        <img src="sal.jpeg" alt="Hlavn√≠ s√°l" class="rounded-lg shadow-md">
                        <img src="bar.jpeg" alt="Bar" class="rounded-lg shadow-md">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Team Section -->
    <section id="team" class="py-16 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-black mb-4">
                    Osoby a obsazen√≠
                </h2>
                <p class="text-xl text-gray-600 max-w-2xl mx-auto">
                    Lep≈°√≠ ne≈æ si mysl√≠te
                </p>
            </div>
            
            <div class="grid gap-8 md:grid-cols-2 max-w-4xl mx-auto">
                <!-- Milo≈° -->
                <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
                    <img src="milos.avif" alt="Milo≈° ƒåerm√°k" class="w-full h-64 object-cover" style="object-position: center top" onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 400 300\\'><rect fill=\\'%23e0e0e0\\'/><text x=\\'50%\\' y=\\'50%\\' text-anchor=\\'middle\\' font-size=\\'20\\' fill=\\'%23999\\'>Milo≈° ƒåerm√°k</text></svg>'">
                    <div class="p-6">
                        <h3 class="text-2xl font-bold text-black mb-2">Milo≈° ƒåerm√°k</h3>
                        <p class="text-gray-600 mb-4">
                            G√©nius k pronajmut√≠
                        </p>
                        <div class="flex space-x-4">
                            <a href="#" class="text-red-600 hover:text-red-800 transition-colors duration-200">
                                <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 6.621 5.367 11.988 11.988 11.988s11.987-5.367 11.987-11.988C24.004 5.367 18.637.001 12.017.001zM8.449 16.988c-1.297 0-2.348-1.051-2.348-2.348s1.051-2.348 2.348-2.348 2.348 1.051 2.348 2.348-1.051 2.348-2.348 2.348zm7.718 0c-1.297 0-2.348-1.051-2.348-2.348s1.051-2.348 2.348-2.348 2.348 1.051 2.348 2.348-1.051 2.348-2.348 2.348z"/>
                                </svg>
                            </a>
                            <a href="#" class="text-red-600 hover:text-red-800 transition-colors duration-200">
                                <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"/>
                                </svg>
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- Ludƒõk -->
                <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
                    <img src="ludek.avif" alt="Ludƒõk Stanƒõk" class="w-full h-64 object-cover" style="object-position: center top" onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 400 300\\'><rect fill=\\'%23e0e0e0\\'/><text x=\\'50%\\' y=\\'50%\\' text-anchor=\\'middle\\' font-size=\\'20\\' fill=\\'%23999\\'>Ludƒõk Stanƒõk</text></svg>'">
                    <div class="p-6">
                        <h3 class="text-2xl font-bold text-black mb-2">Ludƒõk Stanƒõk</h3>
                        <p class="text-gray-600 mb-4">
                            Zjistil, ≈æe je chytr√Ω
                        </p>
                        <div class="flex space-x-4">
                            <a href="#" class="text-red-600 hover:text-red-800 transition-colors duration-200">
                                <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 6.621 5.367 11.988 11.988 11.988s11.987-5.367 11.987-11.988C24.004 5.367 18.637.001 12.017.001zM8.449 16.988c-1.297 0-2.348-1.051-2.348-2.348s1.051-2.348 2.348-2.348 2.348 1.051 2.348 2.348-1.051 2.348-2.348 2.348zm7.718 0c-1.297 0-2.348-1.051-2.348-2.348s1.051-2.348 2.348-2.348 2.348 1.051 2.348 2.348-1.051 2.348-2.348 2.348z"/>
                                </svg>
                            </a>
                            <a href="#" class="text-red-600 hover:text-red-800 transition-colors duration-200">
                                <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"/>
                                </svg>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Instagram Section - TEMPORARILY HIDDEN -->
    <section id="instagram" class="py-16 bg-black" style="display: none;">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">
                    N√°≈° Instagram
                </h2>
                <p class="text-xl text-gray-300 max-w-2xl mx-auto mb-6">
                    Sledujte n√°s pro nejnovƒõj≈°√≠ fotky z akc√≠ a z√°kulis√≠
                </p>
                <a href="https://www.instagram.com/cermakstanekcomedy" target="_blank" rel="noopener noreferrer" class="inline-flex items-center bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-3 rounded-lg font-bold hover:from-purple-700 hover:to-pink-700 transition-all duration-200">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 6.621 5.367 11.988 11.988 11.988s11.987-5.367 11.987-11.988C24.004 5.367 18.637.001 12.017.001zM8.449 16.988c-1.297 0-2.348-1.051-2.348-2.348s1.051-2.348 2.348-2.348 2.348 1.051 2.348 2.348-1.051 2.348-2.348 2.348zm7.718 0c-1.297 0-2.348-1.051-2.348-2.348s1.051-2.348 2.348-2.348 2.348 1.051 2.348 2.348-1.051 2.348-2.348 2.348z"/>
                    </svg>
                    Sledovat @cermakstanekcomedy
                </a>
            </div>
            
            <!-- NoCodeAPI Instagram Feed Integration -->
            <script type="module" src="https://unpkg.com/@nocodeapi/embed-instagram-feed@latest/embed-instagram-feed.js?module"></script>
            
            <div class="instagram-container">
                <!-- Instagram feed will be loaded automatically via NoCodeAPI -->
                <embed-instagram-feed 
                    url="https://v1.nocodeapi.com/YOUR_ENDPOINT_HERE/instagram/YOUR_KEY_HERE"
                    class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                </embed-instagram-feed>
            </div>
            
            <!-- Fallback for when NoCodeAPI is not available -->
            <div id="instagramFallback" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" style="display: none;">
                <!-- Fallback Instagram photos will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Gallery Section -->
    <section id="gallery" class="py-16 bg-black">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">
                    Galerie
                </h2>
                <p class="text-lg text-gray-300 max-w-2xl mx-auto">
                    Pod√≠vejte se na n√°≈° klub a atmosf√©ru na≈°ich akc√≠
                </p>
            </div>
            
            <div id="galleryGrid" class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
                <!-- Gallery images will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Newsletter Section - Temporarily Hidden -->
    <section class="cinema-gradient text-white py-16" style="display: none;">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-4">
                    Z≈Østa≈àte v obraze
                </h2>
                <p class="text-xl text-gray-300 mb-8 max-w-2xl mx-auto">
                    P≈ôihlaste se k newsletteru a nezme≈°kejte ≈æ√°dn√© akce, debaty ani stand-up veƒçery
                </p>
                
                <div id="newsletterSuccess" class="bg-green-600 text-white p-4 rounded-lg max-w-md mx-auto mb-6 hidden">
                    <p class="font-semibold">Dƒõkujeme za p≈ôihl√°≈°en√≠!</p>
                    <p class="text-sm">Budeme v√°s informovat o nov√Ωch akc√≠ch.</p>
                </div>
                
                <form id="newsletterForm" class="max-w-md mx-auto">
                    <div class="flex flex-col sm:flex-row gap-4">
                        <input type="email" id="newsletterEmail" placeholder="Zadejte va≈°i e-mailovou adresu" class="flex-1 px-4 py-3 rounded-lg text-gray-900 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                        <button type="submit" class="bg-red-600 text-white px-8 py-3 rounded-lg font-bold hover:bg-red-700 transition-colors duration-200 transform hover:scale-105">
                            P≈ôihl√°sit se
                        </button>
                    </div>
                </form>
                
                <div class="mt-8 flex justify-center space-x-6">
                    <a href="#" class="text-gray-300 hover:text-white transition-colors duration-200">
                        <span class="sr-only">Facebook</span>
                        <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z"/>
                        </svg>
                    </a>
                    <a href="#" class="text-gray-300 hover:text-white transition-colors duration-200">
                        <span class="sr-only">Instagram</span>
                        <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 6.621 5.367 11.988 11.988 11.988s11.987-5.367 11.987-11.988C24.004 5.367 18.637.001 12.017.001zM8.449 16.988c-1.297 0-2.348-1.051-2.348-2.348s1.051-2.348 2.348-2.348 2.348 1.051 2.348 2.348-1.051 2.348-2.348 2.348zm7.718 0c-1.297 0-2.348-1.051-2.348-2.348s1.051-2.348 2.348-2.348 2.348 1.051 2.348 2.348-1.051 2.348-2.348 2.348z"/>
                        </svg>
                    </a>
                    <a href="#" class="text-gray-300 hover:text-white transition-colors duration-200">
                        <span class="sr-only">Twitter</span>
                        <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contact" class="bg-gray-900 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-4">
                <div>
                    <h3 class="text-2xl font-bold mb-4">Knihovna ƒåerm√°ka a Sta≈àka</h3>
                    <p class="text-gray-400 mb-4">
                        Multifunkƒçn√≠ kulturn√≠ klub na n√°b≈ôe≈æ√≠ Vltavy. M√≠sto pro debaty, standup, workshopy a podcasty.
                    </p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition-colors duration-200">
                            <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z"/>
                            </svg>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors duration-200">
                            <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 6.621 5.367 11.988 11.988 11.988s11.987-5.367 11.987-11.988C24.004 5.367 18.637.001 12.017.001zM8.449 16.988c-1.297 0-2.348-1.051-2.348-2.348s1.051-2.348 2.348-2.348 2.348 1.051 2.348 2.348-1.051 2.348-2.348 2.348zm7.718 0c-1.297 0-2.348-1.051-2.348-2.348s1.051-2.348 2.348-2.348 2.348 1.051 2.348 2.348-1.051 2.348-2.348 2.348z"/>
                            </svg>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors duration-200">
                            <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"/>
                            </svg>
                        </a>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-4">Rychl√© odkazy</h4>
                    <ul class="space-y-2">
                        <li><a href="#program" class="text-gray-400 hover:text-white transition-colors duration-200">Aktu√°ln√≠ program</a></li>
                        <li><a href="#about" class="text-gray-400 hover:text-white transition-colors duration-200">O klubu</a></li>
                        <li><a href="#contact" class="text-gray-400 hover:text-white transition-colors duration-200">Kontakt</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-4">Na≈°e slu≈æby</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors duration-200">Standup comedy</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors duration-200">Rozhovory a debaty</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors duration-200">Worshopy</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors duration-200">Nahr√°v√°n√≠ podcast≈Ø</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-4">Kontakt</h4>
                    <div class="space-y-2 text-gray-400">
                        <p id="contactAddress">Naƒç√≠t√°n√≠...</p>
                        <p class="mt-4">
                            <a href="#" id="contactPhone" class="hover:text-white transition-colors duration-200">Naƒç√≠t√°n√≠...</a>
                        </p>
                        <p>
                            <a href="#" id="contactEmail" class="hover:text-white transition-colors duration-200">Naƒç√≠t√°n√≠...</a>
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; 2024 Knihovna ƒåerm√°ka a Sta≈àka. V≈°echna pr√°va vyhrazena.</p>
            </div>
        </div>
    </footer>

    <!-- Admin Toggle Button -->
    <button class="fixed bottom-4 right-4 w-16 h-16 bg-red-600 text-white rounded-full shadow-xl hover:bg-red-700 transition-colors duration-200 flex items-center justify-center text-2xl z-50 border-2 border-white" id="adminToggle" title="Admin panel">
        ‚öô
    </button>

    <!-- Admin Panel -->
    <div class="fixed inset-y-0 right-0 w-full max-w-md bg-white shadow-xl transform translate-x-full transition-transform duration-300 ease-in-out z-50 overflow-y-auto" id="adminPanel">
        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center">
            <h2 class="text-xl font-bold text-gray-900">Administrace</h2>
            <button class="text-gray-500 hover:text-gray-700 transition-colors duration-200" id="adminClose">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
        <div class="p-6 space-y-8">
            <!-- Add Event Section -->
            <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">P≈ôidat ud√°lost</h3>
                <form id="eventForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">N√°zev ud√°losti *</label>
                        <input type="text" id="eventTitle" required maxlength="100" placeholder="Zadejte n√°zev ud√°losti..." class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500">
                    </div>
                    <!-- Typ ud√°losti odstranƒõn pro zjednodu≈°en√≠ -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Datum *</label>
                            <input type="date" id="eventDate" required min="2024-01-01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ƒåas *</label>
                            <input type="time" id="eventTime" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Popis ud√°losti *</label>
                        <textarea id="eventDescription" required maxlength="500" placeholder="Popi≈°te ud√°lost, jej√≠ program a dal≈°√≠ d≈Øle≈æit√© informace..." rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fotka ud√°losti (URL)</label>
                        <input type="url" id="eventImage" placeholder="https://example.com/image.jpg" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Link na eshop/vstupenky</label>
                        <input type="url" id="eventShopLink" placeholder="https://obchod.example.com/udalost" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Text tlaƒç√≠tka (kdy≈æ chyb√≠ link)</label>
                        <input type="text" id="eventButtonText" placeholder="Vstup zdarma" maxlength="50" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500">
                        <p class="text-xs text-gray-500 mt-1">Nap≈ô: "Vstup zdarma", "Prodej je≈°tƒõ nezah√°jen", "Vyprod√°no" atd.</p>
                    </div>
                    <button type="submit" class="w-full bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition-colors duration-200 font-medium">P≈ôidat ud√°lost</button>
                </form>
            </div>

            <!-- Manage Events Section -->
            <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Spr√°va ud√°lost√≠</h3>
                <div id="eventList" class="space-y-3">
                    <!-- Event list will be populated here -->
                </div>
            </div>

            <!-- Gallery Management Section -->
            <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Spr√°va galerie</h3>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">P≈ôidat novou fotku</label>
                        <input type="url" id="galleryImageUrl" placeholder="https://example.com/image.jpg" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Popis fotky</label>
                        <input type="text" id="galleryImageDescription" placeholder="Popis fotky..." maxlength="100" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500">
                    </div>
                    <button class="w-full bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition-colors duration-200 font-medium" onclick="addGalleryImage()">P≈ôidat fotku</button>
                </div>
                
                <div class="mt-6">
                    <h4 class="text-md font-medium text-gray-900 mb-3">Aktu√°ln√≠ fotky</h4>
                    <div id="galleryAdminList" class="space-y-2">
                        <!-- Gallery admin list will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Edit About Section -->
            <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Upravit O n√°s</h3>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Text o klubu</label>
                        <textarea id="aboutText" rows="6" maxlength="1000" placeholder="Upravte text sekce O n√°s..." class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500"></textarea>
                    </div>
                    <button class="w-full bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition-colors duration-200 font-medium" onclick="saveAboutText()">Ulo≈æit zmƒõny</button>
                </div>
            </div>

            <!-- Edit Contact Section -->
            <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Upravit kontaktn√≠ √∫daje</h3>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Telefon</label>
                        <input type="tel" id="adminContactPhone" placeholder="+420 234 567 890" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                        <input type="email" id="adminContactEmail" placeholder="info@knihovnacs.cz" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Adresa</label>
                        <input type="text" id="adminContactAddress" placeholder="N√°rodn√≠ 28, 110 00 Praha 1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Otev√≠rac√≠ doba</label>
                        <textarea id="adminOpeningHours" rows="3" placeholder="Po-P√°: 18:00-24:00..." class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500"></textarea>
                    </div>
                    <button class="w-full bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition-colors duration-200 font-medium" onclick="saveContactInfo()">Ulo≈æit kontaktn√≠ √∫daje</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Event Detail Modal -->
    <div id="eventModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="relative">
                <button onclick="closeEventDetail()" class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 z-10 bg-white rounded-full p-1">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
                <div id="eventModalContent">
                    <!-- Event detail content will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <script>
        // Supabase configuration
        const SUPABASE_URL = 'https://eyfgtagudbvzorrdntdf.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV5Zmd0YWd1ZGJ2em9ycmRudGRmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ4MzEwMDMsImV4cCI6MjA3MDQwNzAwM30.uw5k8YWuIzM2Q1e8dzwSKXJBlA_wViVdAvtue6Qx0A0';
        
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        // Initialize Stripe - TODO: Replace with actual publishable key when ready for production
        const stripe = Stripe('pk_test_51QaHoKRw2M8c2eL6v4bZyGXzYvNXTqMHUoIjXwJDrE7BF1xKHXLKHFjRGvRmKXzYvNXTqMHUoIjXwJDrE7BF1xK');
        
        // Ticket sales flag - loaded from database
        let TICKET_SALES_ENABLED = false;
        
        // Initialize data storage
        let events = [];
        let galleryImages = [];

        // Navigation scroll effect
        window.addEventListener('scroll', () => {
            const navbar = document.getElementById('navbar');
            if (window.scrollY > 100) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });

        // Mobile menu toggle
        document.getElementById('hamburger').addEventListener('click', () => {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.toggle('hidden');
        });

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    // Close mobile menu if open
                    const mobileMenu = document.getElementById('mobileMenu');
                    if (mobileMenu) {
                        mobileMenu.classList.add('hidden');
                    }
                }
            });
        });

        // Fade in animation on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, observerOptions);

        document.querySelectorAll('.fade-in').forEach(el => {
            observer.observe(el);
        });

        // Admin panel toggle - redirect to admin
        document.getElementById('adminToggle').addEventListener('click', () => {
            if (confirm('Chcete p≈ôej√≠t do administrace?')) {
                window.location.href = 'admin.html';
            }
        });

        document.getElementById('adminClose').addEventListener('click', () => {
            const adminPanel = document.getElementById('adminPanel');
            adminPanel.classList.add('translate-x-full');
        });
        
        // Newsletter form handling
        document.getElementById('newsletterForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('newsletterEmail').value;
            if (email) {
                // Store newsletter subscription
                const subscribers = JSON.parse(localStorage.getItem('subscribers') || '[]');
                if (!subscribers.includes(email)) {
                    subscribers.push(email);
                    localStorage.setItem('subscribers', JSON.stringify(subscribers));
                }
                
                // Show success message
                document.getElementById('newsletterSuccess').classList.remove('hidden');
                document.getElementById('newsletterForm').classList.add('hidden');
                
                // Hide success message after 3 seconds and show form again
                setTimeout(() => {
                    document.getElementById('newsletterSuccess').classList.add('hidden');
                    document.getElementById('newsletterForm').classList.remove('hidden');
                    document.getElementById('newsletterEmail').value = '';
                }, 3000);
            }
        });

        // Load events from Supabase
        async function loadEvents() {
            console.log('Loading events from Supabase...');
            try {
                const { data, error } = await supabase
                    .from('events')
                    .select('*')
                    .order('date', { ascending: true });
                    
                if (error) throw error;
                
                // Transform Supabase data to match our format
                const transformedEvents = (data || []).map(event => ({
                    id: event.id,
                    title: event.title,
                    // type removed for simplification
                    date: event.date,
                    time: event.time,
                    description: event.description,
                    image: event.image,
                    shopLink: event.shop_link || '',
                    buttonText: event.button_text || ''
                }));
                
                events = transformedEvents;
                console.log(`Loaded ${events.length} events:`, events);
                
                // Also save to localStorage
                localStorage.setItem('events', JSON.stringify(events));
                
                renderEvents();
            } catch (error) {
                console.error('Error loading events:', error);
                // Fallback to localStorage if Supabase fails
                console.log('Supabase failed, loading from localStorage...');
                const localEvents = localStorage.getItem('events');
                if (localEvents) {
                    console.log('Loading events from localStorage');
                    events = JSON.parse(localEvents);
                } else {
                    console.log('No local events found, creating defaults...');
                    // Add some default events with images and shop links
                    const today = new Date();
                    const nextWeek = new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000);
                    const nextMonth = new Date(today.getTime() + 14 * 24 * 60 * 60 * 1000);
                    
                    events = [
                        {
                            id: 1,
                            title: 'Stand-up veƒçer s hosty',
                            // type removed
                            date: nextWeek.toISOString().split('T')[0],
                            time: '20:00',
                            description: 'Veƒçer pln√Ω sm√≠chu s p≈ôedn√≠mi ƒçesk√Ωmi komiky. P≈ôipravte se na nonstop z√°bavu a skvƒõlou atmosf√©ru.',
                            image: 'https://images.unsplash.com/photo-1541532713592-79a0317b6b07?w=600&h=300&fit=crop',
                            shopLink: 'https://example.com/vstupenky/standup'
                        },
                        {
                            id: 2,
                            title: 'Debata o budoucnosti AI',
                            type: 'diskuze',
                            date: nextMonth.toISOString().split('T')[0],
                            time: '19:00',
                            description: 'Diskuze s experty o tom, jak umƒõl√° inteligence zmƒõn√≠ na≈°e ≈æivoty. Moderuje Dr. Jan Nov√°k.',
                            image: 'https://images.unsplash.com/photo-1485827404703-89b55fcc595e?w=600&h=300&fit=crop',
                            shopLink: ''
                        }
                    ];
                    localStorage.setItem('events', JSON.stringify(events));
                }
                renderEvents();
            }
        }

        // Instagram feed management (fallback system)
        async function loadInstagramPhotos() {
            console.log('Checking if NoCodeAPI Instagram feed is working...');
            
            // Wait a moment to see if NoCodeAPI loads
            setTimeout(() => {
                const embedElement = document.querySelector('embed-instagram-feed');
                const fallbackElement = document.getElementById('instagramFallback');
                
                if (embedElement && embedElement.children.length === 0) {
                    console.log('NoCodeAPI not working, using fallback...');
                    loadInstagramPhotosFallback();
                    fallbackElement.style.display = 'grid';
                } else {
                    console.log('NoCodeAPI Instagram feed loaded successfully');
                    fallbackElement.style.display = 'none';
                }
            }, 3000); // Wait 3 seconds for NoCodeAPI to load
        }

        // Fallback: Load Instagram photos from admin-managed collection
        async function loadInstagramPhotosFallback() {
            console.log('Loading Instagram photos from admin collection as fallback...');
            try {
                const { data, error } = await supabase
                    .from('instagram_photos')
                    .select('*')
                    .order('created_at', { ascending: false })
                    .limit(12); // Limit to 12 most recent photos
                    
                if (error) throw error;
                
                const instagramPhotos = data || [];
                console.log(`Loaded ${instagramPhotos.length} Instagram photos:`, instagramPhotos);
                
                renderInstagramFeedFallback(instagramPhotos);
                
            } catch (error) {
                console.error('Error loading Instagram photos from Supabase:', error);
                // Fallback to localStorage if available
                const storedPhotos = localStorage.getItem('instagramPhotos');
                if (storedPhotos) {
                    const instagramPhotos = JSON.parse(storedPhotos).slice(0, 12);
                    renderInstagramFeedFallback(instagramPhotos);
                }
            }
        }

        function renderInstagramFeedFallback(photos) {
            const instagramFallback = document.getElementById('instagramFallback');
            
            if (!instagramFallback) {
                console.error('instagramFallback element not found!');
                return;
            }
            
            if (photos.length === 0) {
                console.log('No Instagram photos to display');
                instagramFallback.innerHTML = '<div class="col-span-full text-center py-8"><p class="text-gray-400">Zat√≠m nejsou p≈ôidan√© ≈æ√°dn√© fotky.</p></div>';
                return;
            }
            
            instagramFallback.innerHTML = photos.map(photo => `
                <div class="aspect-square bg-gray-800 rounded-lg overflow-hidden hover:scale-105 transition-transform duration-200">
                    <img 
                        src="${photo.url}" 
                        alt="${photo.caption || 'Instagram post'}" 
                        class="w-full h-full object-cover"
                        onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=\\'w-full h-full bg-gray-700 flex items-center justify-center\\'>üì∑</div>'"
                    >
                </div>
            `).join('');
        }
        
        // Event management
        function renderEvents() {
            console.log('Rendering events:', events);
            const eventsList = document.getElementById('eventsList');
            
            if (!eventsList) {
                console.error('eventsList element not found!');
                return;
            }
            
            if (events.length === 0) {
                console.log('No events to display');
                eventsList.innerHTML = '<div class="text-center py-8"><p class="text-gray-600">Zat√≠m nejsou napl√°novan√© ≈æ√°dn√© ud√°losti.</p></div>';
                return;
            }
            
            // Sort events by date and limit to 10 upcoming events
            const sortedEvents = [...events]
                .sort((a, b) => new Date(a.date) - new Date(b.date))
                .slice(0, 10);

            // Group events by date
            const eventsByDate = {};
            sortedEvents.forEach(event => {
                const date = new Date(event.date);
                const dateKey = date.toLocaleDateString('cs-CZ', { weekday: 'long', day: 'numeric', month: 'long' });
                if (!eventsByDate[dateKey]) {
                    eventsByDate[dateKey] = [];
                }
                eventsByDate[dateKey].push(event);
            });

            // Render events
            let html = '';
            Object.keys(eventsByDate).forEach(dateKey => {
                html += `
                    <div class="bg-black rounded-lg p-6">
                        <h3 class="text-xl font-bold text-white mb-4">${dateKey.charAt(0).toUpperCase() + dateKey.slice(1)}</h3>
                        <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
                `;
                
                eventsByDate[dateKey].forEach(event => {
                    html += `
                        <div class="event-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-lg border border-gray-200 cursor-pointer" onclick="showEventDetail(${event.id})">
                            ${event.image ? `
                                <img src="${event.image}" alt="${event.title}" class="w-full h-32 object-cover" onerror="this.style.display='none'">
                            ` : ''}
                            <div class="p-4">
                                <div class="flex justify-between items-start mb-3">
                                    <div class="text-2xl font-bold text-red-600">
                                        ${event.time.slice(0, 5)}
                                    </div>
                                </div>
                                <h4 class="text-lg font-semibold text-black mb-2">
                                    ${event.title}
                                </h4>
                                <p class="text-gray-600 text-sm mb-3 line-clamp-2">
                                    ${event.description}
                                </p>
                                <div class="flex justify-between items-center">
                                    <!-- Removed status text for cleaner design -->
                                    <button class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors duration-200 text-sm font-medium" onclick="event.stopPropagation(); showEventDetail(${event.id})">
                                        V√≠ce info
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
            });

            // Add "Show all events" button if there are more than 10 events
            if (events.length > 10) {
                html += `
                    <div class="text-center py-8">
                        <a href="program.html" class="inline-block bg-red-600 text-white px-8 py-3 rounded-lg hover:bg-red-700 transition-colors duration-200 font-bold">
                            Zobrazit v≈°echny akce (${events.length})
                        </a>
                    </div>
                `;
            }

            eventsList.innerHTML = html || '<div class="text-center py-12"><p class="text-gray-500 text-lg">≈Ω√°dn√© ud√°losti v t√©to kategorii</p></div>';
        }

        // Initial render
        renderEvents();

        // Admin event list
        function renderEventList() {
            const eventList = document.getElementById('eventList');
            if (events.length === 0) {
                eventList.innerHTML = '<p class="text-gray-500 text-center py-4">≈Ω√°dn√© ud√°losti</p>';
                return;
            }
            
            eventList.innerHTML = events.map(event => {
                const eventDate = new Date(event.date);
                const formattedDate = eventDate.toLocaleDateString('cs-CZ');
                // Type labels removed for simplification
                
                return `
                    <div class="bg-white border border-gray-200 rounded-lg p-4 flex justify-between items-center">
                        <div>
                            <h4 class="font-semibold text-gray-900">${event.title}</h4>
                            <p class="text-sm text-gray-600">${formattedDate} ‚Ä¢ ${event.time.slice(0, 5)}</p>
                        </div>
                        <button class="text-red-600 hover:text-red-800 font-medium text-sm" onclick="deleteEvent(${event.id})">
                            Smazat
                        </button>
                    </div>
                `;
            }).join('');
        }

        // Add event form submission
        document.getElementById('eventForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Get form values
            const title = document.getElementById('eventTitle').value.trim();
            const type = 'standup'; // Default type (using allowed constraint value)
            const date = document.getElementById('eventDate').value;
            const time = document.getElementById('eventTime').value;
            const description = document.getElementById('eventDescription').value.trim();
            const image = document.getElementById('eventImage').value.trim();
            const shopLink = document.getElementById('eventShopLink').value.trim();
            const buttonText = document.getElementById('eventButtonText').value.trim();
            
            // Validation
            if (!title || !date || !time || !description) {
                alert('Pros√≠m vypl≈àte v≈°echna povinn√° pole.');
                return;
            }
            
            // Check if date is not in the past
            const eventDate = new Date(date + 'T' + time);
            const now = new Date();
            if (eventDate < now) {
                if (!confirm('Datum ud√°losti je v minulosti. Chcete pokraƒçovat?')) {
                    return;
                }
            }
            
            try {
                // Create event data for Supabase
                const eventData = {
                    title: title,
                    type: type,
                    date: date,
                    time: time,
                    description: description
                };
                
                // Add optional fields only if not empty
                if (image) eventData.image = image;
                if (shopLink) eventData.shop_link = shopLink;
                if (buttonText) eventData.button_text = buttonText;
                
                // Try to save to Supabase first
                const { data, error } = await supabase
                    .from('events')
                    .insert([eventData]);
                    
                if (error) {
                    console.log('Supabase save failed, saving to localStorage:', error);
                    
                    // Fallback to localStorage
                    const newEvent = {
                        id: Date.now(),
                        title: title,
                        type: type,
                        date: date,
                        time: time,
                        description: description,
                        image: image,
                        shopLink: shopLink,
                        buttonText: buttonText
                    };
                    
                    events.push(newEvent);
                    localStorage.setItem('events', JSON.stringify(events));
                } else {
                    console.log('Event saved to Supabase successfully');
                }
                
                // Reset form
                this.reset();
                
                // Reload events and re-render
                await loadEvents();
                renderEventList();
                
            } catch (error) {
                console.error('Error adding event:', error);
                alert('Chyba p≈ôi p≈ôid√°v√°n√≠ ud√°losti: ' + error.message);
            }
            
            alert('Ud√°lost "' + title + '" byla √∫spƒõ≈°nƒõ p≈ôid√°na!');
        });

        // Delete event
        function deleteEvent(id) {
            if (confirm('Opravdu chcete smazat tuto ud√°lost?')) {
                events = events.filter(event => event.id !== id);
                localStorage.setItem('events', JSON.stringify(events));
                renderEvents();
                renderEventList();
            }
        }

        // Save about text
        async function saveAboutText() {
            const aboutText = document.getElementById('aboutText').value.trim();
            
            console.log('Saving about text:', aboutText);
            
            if (!aboutText) {
                alert('Text nem≈Ø≈æe b√Ωt pr√°zdn√Ω.');
                return;
            }
            
            try {
                // Try to save to Supabase first
                const { error } = await supabase
                    .from('settings')
                    .upsert([{
                        key: 'about_text',
                        value: aboutText
                    }]);
                    
                if (error) {
                    console.log('Supabase save failed, using localStorage:', error);
                    localStorage.setItem('aboutText', aboutText);
                } else {
                    localStorage.setItem('aboutText', aboutText);
                }
                
                // Update the about section immediately
                const aboutMainText = document.getElementById('aboutMainText');
                if (aboutMainText) {
                    aboutMainText.textContent = aboutText;
                }
                
                // Reload all content to ensure sync
                await loadAllContent();
                
                alert('Text sekce "O n√°s" byl √∫spƒõ≈°nƒõ ulo≈æen!');
                
            } catch (error) {
                console.error('Error saving about text:', error);
                localStorage.setItem('aboutText', aboutText);
                
                // Update the about section immediately
                const aboutMainText = document.getElementById('aboutMainText');
                if (aboutMainText) {
                    aboutMainText.textContent = aboutText;
                }
                
                // Reload all content to ensure sync
                await loadAllContent();
                
                alert('Text byl ulo≈æen lok√°lnƒõ (Supabase nedostupn√Ω).');
            }
        }

        // Save contact information
        async function saveContactInfo() {
            const phone = document.getElementById('adminContactPhone').value.trim();
            const email = document.getElementById('adminContactEmail').value.trim();
            const address = document.getElementById('adminContactAddress').value.trim();
            const hours = document.getElementById('adminOpeningHours').value.trim();
            
            if (!phone && !email && !address && !hours) {
                alert('Vypl≈àte alespo≈à jeden √∫daj.');
                return;
            }
            
            try {
                // Prepare settings for Supabase
                const settings = [];
                if (phone) settings.push({ key: 'contact_phone', value: phone });
                if (email) settings.push({ key: 'contact_email', value: email });
                if (address) settings.push({ key: 'contact_address', value: address });
                if (hours) settings.push({ key: 'opening_hours', value: hours });
                
                // Try to save to Supabase
                const { error } = await supabase
                    .from('settings')
                    .upsert(settings);
                    
                if (error) {
                    console.log('Supabase save failed, using localStorage:', error);
                    if (phone) localStorage.setItem('contact_phone', phone);
                    if (email) localStorage.setItem('contact_email', email);
                    if (address) localStorage.setItem('contact_address', address);
                    if (hours) localStorage.setItem('opening_hours', hours);
                } else {
                    if (phone) localStorage.setItem('contact_phone', phone);
                    if (email) localStorage.setItem('contact_email', email);
                    if (address) localStorage.setItem('contact_address', address);
                    if (hours) localStorage.setItem('opening_hours', hours);
                }
                
                // Update contact section on the page
                await loadAllContent();
                
                alert('Kontaktn√≠ √∫daje byly √∫spƒõ≈°nƒõ ulo≈æeny!');
                
            } catch (error) {
                console.error('Error saving contact info:', error);
                if (phone) localStorage.setItem('contact_phone', phone);
                if (email) localStorage.setItem('contact_email', email);
                if (address) localStorage.setItem('contact_address', address);
                if (hours) localStorage.setItem('opening_hours', hours);
                
                await loadAllContent();
                alert('Kontaktn√≠ √∫daje byly ulo≈æeny lok√°lnƒõ (Supabase nedostupn√Ω).');
            }
        }

        // Gallery management functions
        async function addGalleryImage() {
            const url = document.getElementById('galleryImageUrl').value.trim();
            const description = document.getElementById('galleryImageDescription').value.trim();
            
            if (!url) {
                alert('Pros√≠m zadejte URL obr√°zku.');
                return;
            }
            
            if (!url.match(/\.(jpeg|jpg|gif|png|webp)$/i) && !url.includes('unsplash.com') && !url.includes('images.')) {
                if (!confirm('URL nevypad√° jako obr√°zek. Chcete pokraƒçovat?')) {
                    return;
                }
            }
            
            try {
                // Save to Supabase first
                const { data, error } = await supabase
                    .from('gallery')
                    .insert([{
                        url: url,
                        description: description || 'Fotka z klubu'
                    }]);
                    
                if (error) {
                    console.log('Supabase save failed, using localStorage:', error);
                    // Fallback to localStorage
                    const newImage = {
                        id: Date.now(),
                        url: url,
                        description: description || 'Fotka z klubu',
                        date: new Date().toISOString()
                    };
                    galleryImages.push(newImage);
                    localStorage.setItem('galleryImages', JSON.stringify(galleryImages));
                } else {
                    console.log('Image saved to Supabase successfully');
                }
                
                // Reset form
                document.getElementById('galleryImageUrl').value = '';
                document.getElementById('galleryImageDescription').value = '';
                
                // Reload data
                await loadGalleryImages();
                
                alert('Fotka byla √∫spƒõ≈°nƒõ p≈ôid√°na do galerie!');
                
            } catch (error) {
                console.error('Error adding gallery image:', error);
                // Fallback to localStorage
                const newImage = {
                    id: Date.now(),
                    url: url,
                    description: description || 'Fotka z klubu',
                    date: new Date().toISOString()
                };
                galleryImages.push(newImage);
                localStorage.setItem('galleryImages', JSON.stringify(galleryImages));
                
                document.getElementById('galleryImageUrl').value = '';
                document.getElementById('galleryImageDescription').value = '';
                
                renderGallery();
                renderGalleryAdminList();
                
                alert('Fotka byla p≈ôid√°na lok√°lnƒõ (Supabase nedostupn√Ω).');
            }
        }

        async function deleteGalleryImage(id) {
            if (confirm('Opravdu chcete smazat tuto fotku?')) {
                try {
                    // Delete from Supabase first
                    const { error } = await supabase
                        .from('gallery')
                        .delete()
                        .eq('id', id);
                        
                    if (error) {
                        console.log('Supabase delete failed:', error);
                        // Fallback to localStorage
                        galleryImages = galleryImages.filter(img => img.id !== id);
                        localStorage.setItem('galleryImages', JSON.stringify(galleryImages));
                    } else {
                        console.log('Image deleted from Supabase successfully');
                    }
                    
                    // Reload data
                    await loadGalleryImages();
                    
                } catch (error) {
                    console.error('Error deleting gallery image:', error);
                    // Fallback to localStorage
                    galleryImages = galleryImages.filter(img => img.id !== id);
                    localStorage.setItem('galleryImages', JSON.stringify(galleryImages));
                    renderGallery();
                    renderGalleryAdminList();
                }
            }
        }

        function renderGallery() {
            const galleryGrid = document.getElementById('galleryGrid');
            
            if (galleryImages.length === 0) {
                galleryGrid.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <p class="text-gray-400 text-lg">Zat√≠m nem√°me ≈æ√°dn√© fotky v galerii</p>
                    </div>
                `;
                return;
            }
            
            // Show only first 12 images (3 rows of 4)
            const limitedImages = galleryImages.slice(0, 12);
            
            let galleryHtml = limitedImages.map(image => `
                <div class="group relative overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300">
                    <img 
                        src="${image.url}" 
                        alt="${image.description}"
                        class="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-300"
                        onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 400 300\\'><rect fill=\\'%23e0e0e0\\'/><text x=\\'50%\\' y=\\'50%\\' text-anchor=\\'middle\\' font-size=\\'20\\' fill=\\'%23999\\'>Obr√°zek nenalezen</text></svg>'"
                    >
                    <div class="absolute inset-0 bg-black bg-opacity-40 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end">
                        <div class="p-4 text-white">
                            <h3 class="text-lg font-semibold">${image.description}</h3>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Add "Show all photos" button if there are more than 12 photos
            if (galleryImages.length > 12) {
                galleryHtml += `
                    <div class="col-span-full flex justify-center py-8">
                        <a href="galerie.html" class="inline-block bg-red-600 text-white px-8 py-3 rounded-lg hover:bg-red-700 transition-colors duration-200 font-bold">
                            Zobrazit v√≠ce fotek (${galleryImages.length})
                        </a>
                    </div>
                `;
            }
            
            galleryGrid.innerHTML = galleryHtml;
        }

        function renderGalleryAdminList() {
            const galleryAdminList = document.getElementById('galleryAdminList');
            
            if (galleryImages.length === 0) {
                galleryAdminList.innerHTML = '<p class="text-gray-500 text-center py-4">≈Ω√°dn√© fotky</p>';
                return;
            }
            
            galleryAdminList.innerHTML = galleryImages.map(image => `
                <div class="bg-white border border-gray-200 rounded-lg p-3 flex justify-between items-center">
                    <div class="flex items-center space-x-3">
                        <img 
                            src="${image.url}" 
                            alt="${image.description}"
                            class="w-12 h-12 object-cover rounded"
                            onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 50 50\\'><rect fill=\\'%23e0e0e0\\'/><text x=\\'50%\\' y=\\'50%\\' text-anchor=\\'middle\\' font-size=\\'8\\' fill=\\'%23999\\'>!</text></svg>'"
                        >
                        <div>
                            <p class="font-medium text-gray-900">${image.description}</p>
                            <p class="text-sm text-gray-500">${new Date(image.date).toLocaleDateString('cs-CZ')}</p>
                        </div>
                    </div>
                    <button class="text-red-600 hover:text-red-800 font-medium text-sm" onclick="deleteGalleryImage(${image.id})">
                        Smazat
                    </button>
                </div>
            `).join('');
        }

        // Event detail modal functions
        function showEventDetail(eventId) {
            const event = events.find(e => e.id === eventId);
            if (!event) {
                alert('Ud√°lost nenalezena.');
                return;
            }
            
            // Update URL
            window.location.hash = `udalost/${eventId}`;
            
            const eventDate = new Date(event.date);
            const formattedDate = eventDate.toLocaleDateString('cs-CZ', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            // Type labels removed for simplification
            
            // Get current contact address from the page
            const contactAddressElement = document.getElementById('contactAddress');
            const currentAddress = contactAddressElement ? contactAddressElement.innerHTML : 'Knihovna ƒåerm√°ka a Sta≈àka';
            
            const modalContent = document.getElementById('eventModalContent');
            modalContent.innerHTML = `
                ${event.image ? `
                    <img src="${event.image}" alt="${event.title}" class="w-full h-64 object-cover rounded-t-lg" onerror="this.style.display='none'">
                ` : ''}
                <div class="p-6">
                    <div class="mb-4">
                        <span class="inline-block bg-black text-white text-sm font-medium px-3 py-1 rounded-full mb-2">
                            Ud√°lost
                        </span>
                        <h1 class="text-3xl font-bold text-gray-900 mb-2">${event.title}</h1>
                        <div class="flex items-center text-gray-600 mb-4">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                            ${formattedDate}
                        </div>
                        <div class="flex items-center text-gray-600 mb-6">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            ${event.time.slice(0, 5)}
                        </div>
                    </div>
                    
                    <div class="prose max-w-none mb-6">
                        <p class="text-gray-700 leading-relaxed">${event.description}</p>
                    </div>
                    
                    <!-- Ticket section -->
                    <div class="border-t pt-6" id="ticket-section-${event.id}">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">üé´ Vstupenky</h3>
                        <div id="ticket-types-${event.id}" class="space-y-3">
                            <!-- Tickets will be loaded here -->
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                <p class="text-gray-700 font-medium">
                                    ${TICKET_SALES_ENABLED ? 'Naƒç√≠t√°m dostupn√© vstupenky...' : 'Prodej vstupenek bude zah√°jen brzy'}
                                </p>
                            </div>
                        </div>
                        
                        <div class="mt-6 pt-6 border-t">
                            <button onclick="shareEvent(${event.id})" class="inline-block bg-blue-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-blue-700 transition-colors duration-200">
                                üì§ Sd√≠let ud√°lost
                            </button>
                            <div class="mt-4 text-sm text-gray-500">
                                <p>üìç ${currentAddress}</p>
                                <p class="mt-1">Kapacita: 50 m√≠st</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Show modal
            document.getElementById('eventModal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            
            // Load ticket types if sales are enabled
            if (TICKET_SALES_ENABLED) {
                loadTicketTypes(event.id);
            }
        }
        
        function closeEventDetail() {
            document.getElementById('eventModal').classList.add('hidden');
            document.body.style.overflow = 'auto';
            
            // Clear the hash from URL if it's an event
            if (window.location.hash.startsWith('#udalost/')) {
                history.pushState("", document.title, window.location.pathname + window.location.search);
            }
        }
        
        // Close modal when clicking outside
        document.getElementById('eventModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeEventDetail();
            }
        });
        
        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeEventDetail();
            }
        });

        // Share event function
        function shareEvent(eventId) {
            const event = events.find(e => e.id === eventId);
            if (!event) return;
            
            const url = `${window.location.origin}${window.location.pathname}#udalost/${eventId}`;
            const shareText = `${event.title} - ${new Date(event.date).toLocaleDateString('cs-CZ')} v ${event.time.slice(0, 5)}`;
            
            // Try native share API first
            if (navigator.share) {
                navigator.share({
                    title: event.title,
                    text: shareText,
                    url: url
                }).catch(err => {
                    // If sharing fails, copy to clipboard
                    copyToClipboard(url);
                });
            } else {
                // Fallback to copying URL
                copyToClipboard(url);
            }
        }
        
        // Copy to clipboard helper
        function copyToClipboard(text) {
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(text).then(() => {
                    alert('Odkaz byl zkop√≠rov√°n do schr√°nky!');
                }).catch(err => {
                    fallbackCopyToClipboard(text);
                });
            } else {
                fallbackCopyToClipboard(text);
            }
        }
        
        // Fallback copy method for older browsers
        function fallbackCopyToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";
            textArea.style.left = "-999999px";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                document.execCommand('copy');
                alert('Odkaz byl zkop√≠rov√°n do schr√°nky!');
            } catch (err) {
                alert('Nepoda≈ôilo se zkop√≠rovat odkaz. URL: ' + text);
            }
            document.body.removeChild(textArea);
        }

        // URL routing for events
        function handleHashChange() {
            const hash = window.location.hash;
            if (hash.startsWith('#udalost/')) {
                const eventId = parseInt(hash.split('/')[1]);
                if (eventId) {
                    // Wait for events to load if not ready
                    if (events.length === 0) {
                        setTimeout(() => handleHashChange(), 100);
                        return;
                    }
                    showEventDetail(eventId);
                }
            } else {
                // Close modal if no event in URL
                closeEventDetail();
            }
        }
        
        // Listen for hash changes
        window.addEventListener('hashchange', handleHashChange);
        window.addEventListener('load', handleHashChange);

        // Ticket management functions
        async function loadTicketTypes(eventId) {
            if (!TICKET_SALES_ENABLED) {
                return; // Don't load tickets if sales are disabled
            }
            
            try {
                const { data: ticketTypes, error } = await supabase
                    .from('ticket_types')
                    .select('*')
                    .eq('event_id', eventId)
                    .eq('is_active', true)
                    .order('price', { ascending: true });

                if (error) throw error;

                const container = document.getElementById(`ticket-types-${eventId}`);
                if (!container) return;
                
                if (!ticketTypes || ticketTypes.length === 0) {
                    container.innerHTML = `
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                            <p class="text-gray-600">Vstupenky nejsou v prodeji</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = ticketTypes.map(ticketType => {
                    const available = ticketType.max_quantity - ticketType.sold_quantity;
                    const priceKc = (ticketType.price / 100).toFixed(0);
                    
                    return `
                        <div class="border border-gray-200 rounded-lg p-4 flex justify-between items-center">
                            <div>
                                <h4 class="font-semibold text-gray-900">${ticketType.name}</h4>
                                ${ticketType.description ? `<p class="text-sm text-gray-600">${ticketType.description}</p>` : ''}
                                <p class="text-lg font-bold text-red-600">${priceKc} Kƒç</p>
                                <p class="text-xs text-gray-500">Zb√Ωv√°: ${available} ks</p>
                            </div>
                            <div class="flex items-center space-x-2">
                                <select id="quantity-${ticketType.id}" class="border border-gray-300 rounded px-2 py-1 w-16">
                                    ${Array.from({length: Math.min(available, 10)}, (_, i) => 
                                        `<option value="${i+1}">${i+1}</option>`
                                    ).join('')}
                                </select>
                                <button 
                                    onclick="purchaseTicket('${eventId}', '${ticketType.id}')"
                                    class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-semibold transition-colors ${available === 0 ? 'opacity-50 cursor-not-allowed' : ''}"
                                    ${available === 0 ? 'disabled' : ''}
                                >
                                    ${available === 0 ? 'Vyprod√°no' : 'Koupit'}
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');

            } catch (error) {
                console.error('Chyba p≈ôi naƒç√≠t√°n√≠ vstupenek:', error);
                const container = document.getElementById(`ticket-types-${eventId}`);
                if (container) {
                    container.innerHTML = `
                        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                            <p class="text-red-600">Chyba p≈ôi naƒç√≠t√°n√≠ vstupenek. Zkuste to pros√≠m pozdƒõji.</p>
                        </div>
                    `;
                }
            }
        }

        // Purchase ticket function
        async function purchaseTicket(eventId, ticketTypeId) {
            if (!TICKET_SALES_ENABLED) {
                alert('Prodej vstupenek je≈°tƒõ nebyl zah√°jen.');
                return;
            }
            
            const quantitySelect = document.getElementById(`quantity-${ticketTypeId}`);
            const quantity = parseInt(quantitySelect.value);
            const button = event.target;

            try {
                // Show loading state
                button.innerHTML = 'Zpracov√°v√° se...';
                button.disabled = true;

                // Get event and ticket type details
                const eventData = events.find(e => e.id === parseInt(eventId));
                
                const { data: ticketType, error: ticketError } = await supabase
                    .from('ticket_types')
                    .select('*')
                    .eq('id', ticketTypeId)
                    .single();

                if (!eventData || ticketError || !ticketType) {
                    throw new Error('Chyba p≈ôi naƒç√≠t√°n√≠ dat');
                }

                // Create Stripe Checkout session
                const response = await fetch(`${SUPABASE_URL}/functions/v1/create-checkout-session`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
                    },
                    body: JSON.stringify({
                        eventId: eventId,
                        ticketTypeId: ticketTypeId,
                        quantity: quantity,
                        eventName: eventData.title,
                        ticketTypeName: ticketType.name,
                        unitPrice: ticketType.price,
                        totalAmount: ticketType.price * quantity,
                        successUrl: window.location.origin + window.location.pathname + '?payment=success',
                        cancelUrl: window.location.origin + window.location.pathname + '?payment=cancelled'
                    })
                });

                if (!response.ok) {
                    throw new Error('Chyba p≈ôi vytv√°≈ôen√≠ platby');
                }

                const session = await response.json();

                // Redirect to Stripe Checkout
                const result = await stripe.redirectToCheckout({
                    sessionId: session.sessionId
                });

                if (result.error) {
                    throw new Error(result.error.message);
                }

            } catch (error) {
                alert('Chyba p≈ôi n√°kupu: ' + error.message);
                // Reset button
                button.innerHTML = 'Koupit';
                button.disabled = false;
            }
        }

        // Load ticket sales setting from database
        async function loadTicketSalesSetting() {
            try {
                const { data, error } = await supabase
                    .from('settings')
                    .select('value')
                    .eq('key', 'ticket_sales_enabled')
                    .single();
                
                if (data) {
                    TICKET_SALES_ENABLED = data.value === 'true';
                    console.log('Ticket sales enabled:', TICKET_SALES_ENABLED);
                }
            } catch (error) {
                console.log('Ticket sales setting not found, defaulting to false');
                TICKET_SALES_ENABLED = false;
            }
        }

        // Load all content from Supabase
        async function loadAllContent() {
            console.log('Loading all content from Supabase...');
            try {
                const { data, error } = await supabase
                    .from('settings')
                    .select('*');
                    
                if (error) throw error;
                
                console.log('Settings loaded:', data);
                
                if (data && data.length > 0) {
                    data.forEach(setting => {
                        console.log(`Processing setting: key="${setting.key}", value="${setting.value?.substring(0, 50)}..."`);
                        switch(setting.key) {
                            case 'about_text':
                                const aboutMainText = document.getElementById('aboutMainText');
                                if (aboutMainText) {
                                    aboutMainText.textContent = setting.value;
                                }
                                // Also populate admin form
                                const aboutTextAdmin = document.getElementById('aboutText');
                                if (aboutTextAdmin) {
                                    aboutTextAdmin.value = setting.value;
                                }
                                break;
                                
                            case 'about_description':
                                const aboutDescription = document.getElementById('aboutDescription');
                                if (aboutDescription) {
                                    aboutDescription.textContent = setting.value;
                                }
                                break;
                                
                            case 'opening_hours':
                                const openingHoursDisplay = document.getElementById('openingHours');
                                if (openingHoursDisplay) {
                                    openingHoursDisplay.innerHTML = '<strong>' + setting.value.replace('<br>', '</strong><br><strong>') + '</strong>';
                                }
                                // Also populate admin form
                                const openingHoursAdmin = document.getElementById('adminOpeningHours');
                                if (openingHoursAdmin) {
                                    openingHoursAdmin.value = setting.value;
                                }
                                break;
                                
                            case 'contact_address':
                                const contactAddressDisplay = document.getElementById('contactAddress');
                                if (contactAddressDisplay) {
                                    contactAddressDisplay.innerHTML = setting.value;
                                }
                                // Also populate admin form
                                const contactAddressAdmin = document.getElementById('adminContactAddress');
                                if (contactAddressAdmin) {
                                    contactAddressAdmin.value = setting.value;
                                }
                                break;
                                
                            case 'contact_email':
                                const contactEmailDisplay = document.getElementById('contactEmail');
                                if (contactEmailDisplay) {
                                    contactEmailDisplay.textContent = setting.value;
                                }
                                // Also populate admin form
                                const contactEmailAdmin = document.getElementById('adminContactEmail');
                                if (contactEmailAdmin) {
                                    contactEmailAdmin.value = setting.value;
                                }
                                break;
                                
                            case 'contact_phone':
                                const contactPhoneDisplay = document.getElementById('contactPhone');
                                if (contactPhoneDisplay) {
                                    contactPhoneDisplay.textContent = setting.value;
                                }
                                // Also populate admin form
                                const contactPhoneAdmin = document.getElementById('adminContactPhone');
                                if (contactPhoneAdmin) {
                                    contactPhoneAdmin.value = setting.value;
                                }
                                break;
                        }
                    });
                }
            } catch (error) {
                console.error('Error loading content:', error);
                
                // Try to load from localStorage first
                const storedAboutText = localStorage.getItem('aboutText');
                if (storedAboutText) {
                    const aboutMainText = document.getElementById('aboutMainText');
                    if (aboutMainText) {
                        aboutMainText.textContent = storedAboutText;
                    }
                    const aboutTextAdmin = document.getElementById('aboutText');
                    if (aboutTextAdmin) {
                        aboutTextAdmin.value = storedAboutText;
                    }
                }
                
                // Fallback values for other fields
                const fallbacks = {
                    aboutMainText: storedAboutText || 'Knihovna ƒåerm√°ka a Sta≈àka je multifunkƒçn√≠ kulturn√≠ klub s kapacitou 50 m√≠st. Nab√≠z√≠me jedineƒçn√Ω prostor pro debaty, standup comedy, kv√≠zy a nahr√°v√°n√≠ podcast≈Ø.',
                    aboutDescription: 'N√°≈° klub spojuje tradici liter√°rn√≠ch debat s modern√≠mi form√°ty z√°bavy. M√°me vlastn√≠ podcastov√© studio a pravidelnƒõ po≈ô√°d√°me tematick√© veƒçery.',
                    openingHours: localStorage.getItem('opening_hours') || '<strong>√öt‚Äìƒåt:</strong> 18:00‚Äì23:00<br><strong>P√°‚ÄìSo:</strong> 18:00‚Äì01:00<br><strong>Ne‚ÄìPo:</strong> Zav≈ôeno',
                    contactAddress: localStorage.getItem('contact_address') || 'N√°rodn√≠ 28<br>110 00 Praha 1',
                    contactEmail: localStorage.getItem('contact_email') || 'info@knihovnacs.cz',
                    contactPhone: localStorage.getItem('contact_phone') || '+420 234 567 890'
                };
                
                Object.entries(fallbacks).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.innerHTML = value;
                    }
                });
            }
        }

        // Newsletter form already handled above

        // Force refresh all data
        async function forceRefreshData() {
            console.log('Force refreshing all data...');
            await loadEvents();
            await loadAllContent();
            await loadGalleryImages();
        }

        // Load gallery images from Supabase with localStorage sync
        async function loadGalleryImages() {
            console.log('Loading gallery images...');
            try {
                // First try Supabase
                const { data, error } = await supabase
                    .from('gallery')
                    .select('*')
                    .order('created_at', { ascending: false });
                    
                if (error) throw error;
                
                galleryImages = data || [];
                
                // Also update localStorage for offline use
                localStorage.setItem('galleryImages', JSON.stringify(galleryImages));
                
                console.log(`Loaded ${galleryImages.length} gallery images from Supabase`);
                
            } catch (error) {
                console.error('Error loading gallery from Supabase:', error);
                // Fallback to localStorage if Supabase fails
                console.log('Supabase failed, loading from localStorage...');
                const storedImages = localStorage.getItem('galleryImages');
                if (storedImages) {
                    console.log('Loading gallery from localStorage');
                    galleryImages = JSON.parse(storedImages);
                } else {
                    console.log('No gallery found, using defaults');
                    // Add some default gallery images
                    galleryImages = [
                        {
                            id: 1,
                            url: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=600&h=400&fit=crop',
                            description: 'Hlavn√≠ s√°l klubu',
                            date: new Date().toISOString()
                        },
                        {
                            id: 2,
                            url: 'https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=600&h=400&fit=crop',
                            description: 'Atmosf√©ra bƒõhem debaty',
                            date: new Date().toISOString()
                        },
                        {
                            id: 3,
                            url: 'https://images.unsplash.com/photo-1505373877841-8d25f7d46678?w=600&h=400&fit=crop',
                            description: 'Podcastov√© studio',
                            date: new Date().toISOString()
                        }
                    ];
                    localStorage.setItem('galleryImages', JSON.stringify(galleryImages));
                }
            }
            renderGallery();
            renderGalleryAdminList();
        }

        // Payment result functions
        function showPaymentSuccess() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white p-6 rounded-lg max-w-md shadow-xl">
                    <h3 class="text-2xl font-bold text-green-600 mb-3">‚úÖ Platba √∫spƒõ≈°n√°!</h3>
                    <p class="text-gray-700 mb-4">Dƒõkujeme za n√°kup vstupenky. Potvrzen√≠ a vstupenka byly odesl√°ny na v√°≈° email.</p>
                    <button onclick="this.closest('.fixed').remove()" class="bg-green-600 hover:bg-green-700 text-white font-bold px-6 py-2 rounded-lg transition-colors">
                        Rozum√≠m
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Auto-close after 10 seconds
            setTimeout(() => {
                modal.remove();
            }, 10000);
        }

        function showPaymentCancelled() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white p-6 rounded-lg max-w-md shadow-xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-3">‚ùå Platba byla zru≈°ena</h3>
                    <p class="text-gray-600 mb-4">N√°kup nebyl dokonƒçen. M≈Ø≈æete to zkusit znovu.</p>
                    <button onclick="this.closest('.fixed').remove()" class="bg-gray-600 hover:bg-gray-700 text-white font-bold px-6 py-2 rounded-lg transition-colors">
                        Zav≈ô√≠t
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Auto-close after 5 seconds
            setTimeout(() => {
                modal.remove();
            }, 5000);
        }

        // Initialize the application
        async function initApp() {
            await loadEvents();
            await loadAllContent();
            await loadTicketSalesSetting();
            await loadGalleryImages();
            await loadInstagramPhotos();
            if (typeof renderEventList === 'function') {
                renderEventList();
            }
            
            // Handle payment results
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('payment') === 'success') {
                showPaymentSuccess();
                // Clean URL
                window.history.replaceState({}, document.title, window.location.pathname);
            } else if (urlParams.get('payment') === 'cancelled') {
                showPaymentCancelled();
                // Clean URL
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        }
        
        // Start the app when DOM is loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initApp);
        } else {
            initApp();
        }

        // Auto-refresh data every 15 seconds
        setInterval(async function() {
            if (!document.hidden) {
                console.log('Auto-refreshing data from Supabase...');
                await loadEvents();
                await loadGalleryImages();
                await loadInstagramPhotos();
            }
        }, 15000);

        // Refresh data when page gains focus (returning from admin panel)
        window.addEventListener('focus', function() {
            // Delay to ensure localStorage is updated
            setTimeout(async () => {
                console.log('Page gained focus, refreshing data...');
                await loadEvents();
                await loadAllContent();
                await loadGalleryImages();
                await loadInstagramPhotos();
            }, 100);
        });

        // Also listen for storage events (when localStorage changes in another tab)
        window.addEventListener('storage', function(e) {
            if (e.key === 'events' || e.key === 'galleryImages' || e.key === 'instagramPhotos') {
                console.log('localStorage changed, refreshing data...');
                setTimeout(async () => {
                    if (e.key === 'events') {
                        await loadEvents();
                    }
                    if (e.key === 'galleryImages') {
                        await loadGalleryImages();
                    }
                    if (e.key === 'instagramPhotos') {
                        await loadInstagramPhotos();
                    }
                }, 100);
            }
        });

        // Add keyboard shortcut for admin panel (Ctrl + Shift + A)
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                if (confirm('Chcete p≈ôej√≠t do administrace?')) {
                    window.location.href = 'admin.html';
                }
            }
        });

        // Close admin panel when clicking outside
        document.addEventListener('click', function(e) {
            const adminPanel = document.getElementById('adminPanel');
            const adminToggle = document.getElementById('adminToggle');
            
            if (!adminPanel.contains(e.target) && !adminToggle.contains(e.target)) {
                adminPanel.classList.remove('active');
            }
        });

        // Prevent closing when clicking inside admin panel
        document.getElementById('adminPanel').addEventListener('click', function(e) {
            e.stopPropagation();
        });
    </script>
</body>
</html>